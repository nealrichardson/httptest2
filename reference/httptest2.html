<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>httptest2: A Test Environment for HTTP Requests — httptest2 • httptest2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="httptest2: A Test Environment for HTTP Requests — httptest2"><meta property="og:description" content="The httptest2 package lets you test R code that wraps an API without
requiring access to the remote service. It provides multiple test contexts
that mock the network connection in different ways. with_mock_api() lets
you provide custom fixtures as responses to requests, stored as plain-text
files in your test directory. without_internet() converts HTTP requests
into errors that print the request method, URL, and body payload, if
provided, allowing you to assert that a function call would make a
correctly-formed HTTP request or assert that a function does not make a
request (because if it did, it would raise an error in this context)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-104182925-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-104182925-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">httptest2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/httptest2.html">Get Started</a>
</li>
<li>
  <a href="../reference/">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/httptest2.html">Overview</a>
    </li>
    <li>
      <a href="../articles/redacting.html">Redacting Sensitive Information</a>
    </li>
    <li>
      <a href="../articles/vignettes.html">Using with Vignettes</a>
    </li>
    <li>
      <a href="../articles/faq.html">FAQ</a>
    </li>
  </ul></li>
<li>
  <a href="../news/">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nealrichardson/httptest2" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
<li>
  <a href="https://enpiar.com" class="external-link">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1><code>httptest2</code>: A Test Environment for HTTP Requests</h1>
    <small class="dont-index">Source: <a href="https://github.com/nealrichardson/httptest2/blob/1.2.1/R/httptest2.R" class="external-link"><code>R/httptest2.R</code></a></small>
    <div class="hidden name"><code>httptest2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>httptest2</code> package lets you test R code that wraps an API without
requiring access to the remote service. It provides multiple test contexts
that mock the network connection in different ways. <code><a href="with_mock_api.html">with_mock_api()</a></code> lets
you provide custom fixtures as responses to requests, stored as plain-text
files in your test directory. <code><a href="without_internet.html">without_internet()</a></code> converts HTTP requests
into errors that print the request method, URL, and body payload, if
provided, allowing you to assert that a function call would make a
correctly-formed HTTP request or assert that a function does not make a
request (because if it did, it would raise an error in this context).</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>The package also includes <code><a href="capture_requests.html">capture_requests()</a></code>, a context that collects the
responses from requests you make and stores them as mock files. This enables
you to perform a series of requests against a live server once and then build
your test suite using those mocks, running your tests in <code><a href="with_mock_api.html">with_mock_api()</a></code>.
For a context that combines both recording and mocking, use
<code><a href="with_mock_dir.html">with_mock_dir()</a></code>: it records the first time it is run, and subsequent
runs use the mocks for offline testing.</p>
<p><code>httptest2</code> also includes expectations to assert that HTTP requests
were—or were not—made. <code><a href="expect_verb.html">expect_GET()</a></code>, <code><a href="expect_verb.html">expect_PUT()</a></code>, <code><a href="expect_verb.html">expect_PATCH()</a></code>,
<code><a href="expect_verb.html">expect_POST()</a></code>, and <code><a href="expect_verb.html">expect_DELETE()</a></code> assert that the specified HTTP request
is made within one of the test contexts. They catch the error or message
raised by the mocked HTTP service and check that the request URL and optional
body match the expectation. <code><a href="expect_verb.html">expect_no_request()</a></code> is the inverse of those: it
asserts that no error or message from a mocked HTTP service is raised.
<code><a href="expect_request_header.html">expect_request_header()</a></code> asserts that an HTTP request, mocked or not,
contains a request header.</p>
<p>For an overview of testing with <code>httptest2</code>, see <code><a href="../articles/httptest2.html">vignette("httptest2")</a></code>.</p>
<p>When recording requests, by default <code>httptest2</code> looks for and redacts the
standard ways that auth credentials are passed in requests. This prevents you
from accidentally publishing your personal tokens. The redacting behavior is
fully customizable, either by providing a <code>function (response) {...}</code> to
<code><a href="set_redactor.html">set_redactor()</a></code>, or by placing a function in your package's
<code>inst/httptest2/redact.R</code> that will be used automatically any time you record
requests with your package loaded. See <code><a href="../articles/redacting.html">vignette("redacting")</a></code> for details.</p>
<p><code>httptest2</code> also enables you to write package vignettes and other R Markdown
documents that communicate with a remote API. By adding as little as
<code><a href="start_vignette.html">start_vignette()</a></code> to the beginning of your vignette, you can safely record
API responses from a live session, using your secret credentials. These API
responses are scrubbed of sensitive personal information and stored in a
subfolder in your <code>vignettes</code> directory. Subsequent vignette builds,
including on continuous-integration services, CRAN, and your package users'
computers, use these recorded responses, allowing the document to regenerate
without a network connection or API credentials. To record fresh API
responses, delete the subfolder of cached responses and re-run. See
<code><a href="../articles/vignettes.html">vignette("vignettes")</a></code> for more discussion and links to examples.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://enpiar.com/httptest2/">https://enpiar.com/httptest2/</a></p></li>
<li><p><a href="https://github.com/nealrichardson/httptest2" class="external-link">https://github.com/nealrichardson/httptest2</a></p></li>
<li><p>Report bugs at <a href="https://github.com/nealrichardson/httptest2/issues" class="external-link">https://github.com/nealrichardson/httptest2/issues</a></p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><strong>Maintainer</strong>: Neal Richardson <a href="mailto:neal.p.richardson@gmail.com">neal.p.richardson@gmail.com</a> (<a href="https://orcid.org/0009-0002-7992-3520" class="external-link">ORCID</a>)</p>
<p>Other contributors:</p><ul><li><p>Jonathan Keane <a href="mailto:jkeane@gmail.com">jkeane@gmail.com</a> [contributor]</p></li>
<li><p>Maëlle Salmon <a href="mailto:maelle.salmon@yahoo.se">maelle.salmon@yahoo.se</a> (<a href="https://orcid.org/0000-0002-2815-0399" class="external-link">ORCID</a>) [contributor]</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Neal Richardson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

